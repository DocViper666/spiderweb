function findCountry(t,e){for(var a=0;a<t.length;a++)if(t[a].WPX==e)return t[a]}function buildHtmlTable(t,e,a,n,s){if(null!=e){var l=new Array,o=new Date,p="00"+o.getUTCDate();p=p.substring(p.length-2,p.length);var r="00"+(Number(o.getUTCMonth())+1);r=r.substring(r.length-2,r.length);var c=o.getUTCFullYear();dt_current=p+"/"+r+"/"+c,$(t).empty();for(var i=0;i<e.length;i++){l[i]=e[i].rowid;var d=$('<tr id="'+e[i].rowid+'"/>'),g=a.find(t=>t==e[i].rowid);null!=s?s==e[i].de?d=$('<tr id="'+e[i].rowid+'"/>'):s==e[i].dx&&(d=$('<tr id="'+e[i].rowid+'"/>')):null==g&&a.length>0&&(d=$('<tr class="table-info" id="'+e[i].rowid+'"/>'));var m=findCountry(n,e[i].spotdxcc);e[i].de==s?de="<b>"+e[i].de+"</b>":de=e[i].de,d.append($("<td/>").html('<a href="https://www.qrz.com/db/'+e[i].de+'" target="_blank" rel="noopener"><i class="search" aria-label="'+e[i].de+'"></i></a><span>&nbsp'+de+"</span></b>"));var h=Intl.NumberFormat("it-IT",{style:"decimal"}).format(e[i].freq);d.append($("<td/>").html('<span class="badge bg-warning text-dark badge-responsive">'+h+"</span>")),e[i].dx==s?dx="<b>"+e[i].dx+"</b>":dx=e[i].dx,d.append($("<td/>").html('<a href="https://www.qrz.com/db/'+e[i].dx+'" target="_blank" rel="noopener"><i class="search" aria-label="'+e[i].dx+'"></i></a><span>&nbsp'+dx+"</span>"));try{d.append($("<td/>").html('<span class="img-flag flag-icon flag-icon-'+m.ISO+'" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover" data-bs-placement="left" data-bs-content="'+m.country+'"></span>'))}catch(t){d.append($("<td/>"))}d.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(m.country)),d.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(e[i].comm));var u=new Date(1e3*e[i].time),b="00"+u.getUTCHours();b=b.substring(b.length-2,b.length);var v="00"+u.getMinutes();v=v.substring(v.length-2,v.length);var f="00"+u.getUTCDate();f=f.substring(f.length-2,f.length);var _="00"+(Number(u.getUTCMonth())+1);_=_.substring(_.length-2,_.length);var y=u.getUTCFullYear();tm=b+":"+v,(u=f+"/"+_+"/"+y)==dt_current?d.append($("<td/>").html(tm)):d.append($("<td/>").html('<table class="table-sm table-borderless"><tbody><tr style="background-color:transparent"><td>'+tm+"</td></tr><tr><td>"+u+"</td></tr></tbody></table>")),$(t).append(d)}$(function(){$('[data-bs-toggle="popover"]').popover({container:t})});try{return Array.from(l)}catch(t){return}}}function mySearch(t){t.preventDefault(),myTimer()}function myTimer(){var t=new XMLHttpRequest;selectedBand=[].map.call(document.getElementById("band").selectedOptions,t=>t.value),selectedDEre=[].map.call(document.getElementById("de_re").selectedOptions,t=>t.value),selectedDXre=[].map.call(document.getElementById("dx_re").selectedOptions,t=>t.value),selectedMode=[].map.call(document.getElementById("mode").selectedOptions,t=>t.value);var e="",a="";selectedBand.length<14&&(e=selectedBand.map(function(t,e){return"b="+t}).join("&"));var n="";selectedDEre.length<7&&(n=selectedDEre.map(function(t,e){return"e="+t}).join("&")),a=e&&n?e.concat("&".concat(n)):e.concat(n);var s="";selectedDXre.length<7&&(s=selectedDXre.map(function(t,e){return"x="+t}).join("&")),a=a&&s?a.concat("&".concat(s)):a.concat(s);var l="";selectedMode.length<3&&(l=selectedMode.map(function(t,e){return"m="+t}).join("&"));var o="spotlist";(a=a&&l?a.concat("&".concat(l)):a.concat(l))&&(o=o.concat("?".concat(a))),t.open("GET",o,!0),t.onload=function(){try{rows_list=buildHtmlTable("#bodyspot",JSON.parse(this.response),rows_list,my_countries.country_codes)}catch(t){console.log(t),console.log(t.stack)}},t.send()}function buildHtmlPlots(t,e){$(t).empty();var a=$('<div class="container justify-content-center"/>');a.append($('<h3  class="text-center"/>').html("Band Activity")),a.append($('<img class="img-fluid" src="/static/plots/'+e.propagation_heatmaps_AF+'.png" alt="propatation heatmap AF" srcset="/static/plots/'+e.propagation_heatmaps_AF+'.svg">')),a.append($('<img class="img-fluid" src="/static/plots/'+e.propagation_heatmaps_AN+'.png" alt="propatation heatmap AN" srcset="/static/plots/'+e.propagation_heatmaps_AN+'.svg">')),a.append($('<img class="img-fluid" src="/static/plots/'+e.propagation_heatmaps_AS+'.png" alt="propatation heatmap AS" srcset="/static/plots/'+e.propagation_heatmaps_AS+'.svg">')),a.append($('<img class="img-fluid" src="/static/plots/'+e.propagation_heatmaps_EU+'.png" alt="propatation heatmap EU" srcset="/static/plots/'+e.propagation_heatmaps_EU+'.svg">')),a.append($('<img class="img-fluid" src="/static/plots/'+e.propagation_heatmaps_NA+'.png" alt="propatation heatmap NA" srcset="/static/plots/'+e.propagation_heatmaps_NA+'.svg">')),a.append($('<img class="img-fluid" src="/static/plots/'+e.propagation_heatmaps_OC+'.png" alt="propatation heatmap OC" srcset="/static/plots/'+e.propagation_heatmaps_OC+'.svg">')),a.append($('<img class="img-fluid" src="/static/plots/'+e.propagation_heatmaps_SA+'.png" alt="propatation heatmap SA" srcset="/static/plots/'+e.propagation_heatmaps_SA+'.svg">')),$(t).append(a),$(t).append($("<hr>"));var n=$('<div class="container justify-content-center"/>');n.append($('<img class="img-fluid" src="/static/plots/'+e.qso_months+'.png" alt="Qso per months" srcset="/static/plots/'+e.qso_months+'.svg">')),$(t).append(n)}function plotsTimer(){var t=new XMLHttpRequest;t.open("GET","plotlist",!0),t.onload=function(){try{plot_list=buildHtmlPlots("#plotlist",JSON.parse(this.response))}catch(t){console.log(t),console.log(t.stack)}},t.send()}function myCallsignSearch(){callsign=document.getElementById("callsignInput").value,callsign.replace(/\s/g,"").length>0&&(location.href="/callsign.html?c=".concat(callsign.trim().toUpperCase()))}