var adxo_url="http://www.ng3k.com/misc/adxo.html",qrz_url="https://www.qrz.com/db/";function findCountry(t,a){for(var e=0;e<t.length;e++)if(t[e].WPX==a)return t[e]}function findAdxo(t,a){if(t)for(var e=0;e<t.length;e++)if(t[e].callsign==a)return t[e]}function buildHtmlTable(t,a,e,n,s){if(null!=a){var l=new Array,o=new Date,r="00"+o.getUTCDate();r=r.substring(r.length-2,r.length);var p="00"+(Number(o.getUTCMonth())+1);p=p.substring(p.length-2,p.length);var c=o.getUTCFullYear();dt_current=r+"/"+p+"/"+c,$(t).empty();for(var i=0;i<a.length;i++){l[i]=a[i].rowid;var d=$('<tr id="'+a[i].rowid+'"/>'),g=e.find(t=>t==a[i].rowid);null!=s?s==a[i].de?d=$('<tr id="'+a[i].rowid+'"/>'):s==a[i].dx&&(d=$('<tr id="'+a[i].rowid+'"/>')):null==g&&e.length>0&&(d=$('<tr class="table-info" id="'+a[i].rowid+'"/>'));var m=findCountry(n,a[i].spotdxcc);a[i].de==s?de="<mark>"+a[i].de+"</mark>":de=a[i].de,d.append($("<td/>").html('<a href="'+qrz_url+a[i].de+'" target="_blank" rel="noopener"><i class="bi-search" aria-label="'+a[i].de+'"></i></a><span>&nbsp'+de+"</span></b>"));var u=Intl.NumberFormat("it-IT",{style:"decimal"}).format(a[i].freq);d.append($("<td/>").html('<span class="badge bg-warning text-dark badge-responsive">'+u+"</span>")),a[i].dx==s?dx="<mark>"+a[i].dx+"</mark>":dx=a[i].dx;var h=findAdxo(my_adxo_events,a[i].dx),b="<a href="+adxo_url+" target=_blank rel=noopener >NG3K Website</a>";null!=h&&(dx=dx+'&nbsp<a tabindex="0" class="bi-megaphone-fill" style="color: cornflowerblue;" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="focus" data-bs-sanitize="true" data-bs-placement="auto" data-bs-html="true" data-bs-title="Announced DX Op.: '+h.summary+'" data-bs-content="'+h.description+" data from &nbsp"+b+'"></a>'),d.append($("<td/>").html('<a href="'+qrz_url+a[i].dx+'" target="_blank" rel="noopener"><i class="bi-search" aria-label="'+a[i].dx+'"></i></a><span>&nbsp'+dx+"</span>"));try{d.append($("<td/>").html('<span class="img-flag flag-icon flag-icon-'+m.ISO+'" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover" data-bs-placement="left" data-bs-content="'+m.country+'"></span>'))}catch(t){d.append($("<td/>"))}d.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(m.country)),d.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(a[i].comm));var f=new Date(1e3*a[i].time),_="00"+f.getUTCHours();_=_.substring(_.length-2,_.length);var v="00"+f.getMinutes();v=v.substring(v.length-2,v.length);var y="00"+f.getUTCDate();y=y.substring(y.length-2,y.length);var x="00"+(Number(f.getUTCMonth())+1);x=x.substring(x.length-2,x.length);var w=f.getUTCFullYear();tm=_+":"+v,(f=y+"/"+x+"/"+w)==dt_current?d.append($("<td/>").html(tm)):d.append($("<td/>").html('<table class="table-sm table-borderless"><tbody><tr style="background-color:transparent"><td>'+tm+"</td></tr><tr><td>"+f+"</td></tr></tbody></table>")),$(t).append(d)}$(function(){$('[data-bs-toggle="popover"]').popover({container:t})});try{return Array.from(l)}catch(t){return}}}function mySearch(t){t.preventDefault(),myTimer()}function myTimer(){var t=new XMLHttpRequest;selectedBand=[].map.call(document.getElementById("band").selectedOptions,t=>t.value),selectedDEre=[].map.call(document.getElementById("de_re").selectedOptions,t=>t.value),selectedDXre=[].map.call(document.getElementById("dx_re").selectedOptions,t=>t.value),selectedMode=[].map.call(document.getElementById("mode").selectedOptions,t=>t.value);var a="",e="";selectedBand.length<14&&(a=selectedBand.map(function(t,a){return"b="+t}).join("&"));var n="";selectedDEre.length<7&&(n=selectedDEre.map(function(t,a){return"e="+t}).join("&")),e=a&&n?a.concat("&".concat(n)):a.concat(n);var s="";selectedDXre.length<7&&(s=selectedDXre.map(function(t,a){return"x="+t}).join("&")),e=e&&s?e.concat("&".concat(s)):e.concat(s);var l="";selectedMode.length<3&&(l=selectedMode.map(function(t,a){return"m="+t}).join("&"));var o="spotlist";(e=e&&l?e.concat("&".concat(l)):e.concat(l))&&(o=o.concat("?".concat(e))),t.open("GET",o,!0),t.onload=function(){try{rows_list=buildHtmlTable("#bodyspot",JSON.parse(this.response),rows_list,my_countries.country_codes)}catch(t){console.log(t),console.log(t.stack)}},t.send()}function buildHtmlPlots(t,a){$(t).empty();var e=$('<div class="container justify-content-center"/>');e.append($('<h3  class="text-center"/>').html("Band Activity")),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_AF+'.png" alt="propagation heatmap AF" srcset="/static/plots/'+a.propagation_heatmaps_AF+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_AN+'.png" alt="propagation heatmap AN" srcset="/static/plots/'+a.propagation_heatmaps_AN+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_AS+'.png" alt="propagation heatmap AS" srcset="/static/plots/'+a.propagation_heatmaps_AS+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_EU+'.png" alt="propagation heatmap EU" srcset="/static/plots/'+a.propagation_heatmaps_EU+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_NA+'.png" alt="propagation heatmap NA" srcset="/static/plots/'+a.propagation_heatmaps_NA+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_OC+'.png" alt="propagation heatmap OC" srcset="/static/plots/'+a.propagation_heatmaps_OC+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_SA+'.png" alt="propagation heatmap SA" srcset="/static/plots/'+a.propagation_heatmaps_SA+'.svg">')),$(t).append(e),$(t).append($("<hr>"));var n=$('<div class="container justify-content-center"/>');n.append($('<img class="img-fluid" src="/static/plots/'+a.qso_months+'.png" alt="Qso per months" srcset="/static/plots/'+a.qso_months+'.svg">')),$(t).append(n),n.append($('<img class="img-fluid" src="/static/plots/'+a.qso_hour_band+'.png" alt="Qso per hour/band"  srcset="/static/plots/'+a.qso_hour_band+'.svg">')),$(t).append(n),n.append($('<img class="img-fluid" src="/static/plots/'+a.qso_trend+'.png" alt="Qso trend"  srcset="/static/plots/'+a.qso_trend+'.svg">')),$(t).append(n)}function plotsTimer(){var t=new XMLHttpRequest;t.open("GET","plotlist",!0),t.onload=function(){try{plot_list=buildHtmlPlots("#plotlist",JSON.parse(this.response))}catch(t){console.log(t),console.log(t.stack)}},t.send()}function myCallsignSearch(){callsign=document.getElementById("callsignInput").value,callsign.replace(/\s/g,"").length>0&&(location.href="/callsign.html?c=".concat(callsign.trim().toUpperCase()))}