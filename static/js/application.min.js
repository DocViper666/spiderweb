function findCountry(t,a){for(var e=0;e<t.length;e++)if(t[e].WPX==a)return t[e]}function buildHtmlTable(t,a,e,s){var n=new Array;$(t).empty();for(var p=0;p<a.length;p++){n[p]=a[p].rowid;var l=$('<tr id="'+a[p].rowid+'"/>');null==e.find(t=>t==a[p].rowid)&&e.length>0&&(l=$('<tr class="table-primary" id="'+a[p].rowid+'"/>'));var o=findCountry(s,a[p].spotdxcc);l.append($("<td/>").html('<a href="https://www.qrz.com/db/'+a[p].de+'" target="_blank" rel="noopener"><i class="search" aria-label="'+a[p].de+'"></i></a><span>&nbsp'+a[p].de+"</span>"));var r=Intl.NumberFormat("it-IT",{style:"decimal"}).format(a[p].freq);l.append($("<td/>").html('<span class="badge badge-warning badge-responsive">'+r+"</span>")),l.append($("<td/>").html('<a href="https://www.qrz.com/db/'+a[p].dx+'" target="_blank" rel="noopener"><i class="search" aria-label="'+a[p].dx+'"></i></a><span>&nbsp'+a[p].dx+"</span>"));try{l.append($("<td/>").html('<a href="#" data-toggle="tooltip" title="'+o.country+'"><img src="https://www.countryflags.io/'+o.ISO+'/shiny/24.png" alt="'+o.country+'"></a>'))}catch(t){l.append($("<td/>"))}l.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(a[p].comm));var i=new Date(1e3*a[p].time),c="00"+i.getUTCHours();c=c.substring(c.length-2,c.length);var d="00"+i.getMinutes();d=d.substring(d.length-2,d.length);var m="00"+i.getDate();m=m.substring(m.length-2,m.length);var g="00"+(Number(i.getUTCMonth())+1);g=g.substring(g.length-2,g.length);var h=i.getUTCFullYear();tm=c+":"+d,i=m+"/"+g+"/"+h,l.append($("<td/>").html(tm)),l.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(i)),$(t).append(l)}try{return Array.from(n)}catch(t){return}}function mySearch(t){t.preventDefault(),myTimer()}function myTimer(){var t=new XMLHttpRequest;selectedBands=[].map.call(document.getElementById("band").selectedOptions,t=>t.value),selectedDEre=[].map.call(document.getElementById("de_re").selectedOptions,t=>t.value),selectedDXre=[].map.call(document.getElementById("dx_re").selectedOptions,t=>t.value);var a="",e="";selectedBands.length<14&&(a=selectedBands.map(function(t,a){return"b="+t}).join("&"));var s="";selectedDEre.length<7&&(s=selectedDEre.map(function(t,a){return"e="+t}).join("&")),e=a&&s?a.concat("&".concat(s)):a.concat(s);var n="";selectedDXre.length<7&&(n=selectedDXre.map(function(t,a){return"x="+t}).join("&"));var p="spotlist";(e=e&&n?e.concat("&".concat(n)):e.concat(n))&&(p=p.concat("?".concat(e))),t.open("GET",p,!0),t.onload=function(){try{rows_list=buildHtmlTable("#bodyspot",JSON.parse(this.response),rows_list,my_countries.country_codes)}catch(t){console.log(this.response)}},t.send()}function buildHtmlPlots(t,a){$(t).empty();var e=$('<div class="container justify-content-center"/>');e.append($('<h3  class="text-center"/>').html("Band Activity")),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_AF+'.png" alt="propatation heatmap AF" srcset="/static/plots/'+a.propagation_heatmaps_AF+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_AN+'.png" alt="propatation heatmap AN" srcset="/static/plots/'+a.propagation_heatmaps_AN+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_AS+'.png" alt="propatation heatmap AF" srcset="/static/plots/'+a.propagation_heatmaps_AF+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_EU+'.png" alt="propatation heatmap EU" srcset="/static/plots/'+a.propagation_heatmaps_EU+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_NA+'.png" alt="propatation heatmap NA" srcset="/static/plots/'+a.propagation_heatmaps_NA+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_OC+'.png" alt="propatation heatmap OC" srcset="/static/plots/'+a.propagation_heatmaps_OC+'.svg">')),e.append($('<img class="img-fluid" src="/static/plots/'+a.propagation_heatmaps_SA+'.png" alt="propatation heatmap SA" srcset="/static/plots/'+a.propagation_heatmaps_SA+'.svg">')),$(t).append(e),$(t).append($("<hr>"));var s=$('<div class="container justify-content-center"/>');s.append($('<img class="img-fluid" src="/static/plots/'+a.qso_months+'.png" alt="Qso per months" srcset="/static/plots/'+a.qso_months+'.svg">')),$(t).append(s)}function plotsTimer(){var t=new XMLHttpRequest;t.open("GET","plotlist",!0),t.onload=function(){try{plot_list=buildHtmlPlots("#plotlist",payload_json)}catch(t){console.log(this.response)}},t.send()}