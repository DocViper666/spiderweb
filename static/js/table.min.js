var adxo_url="http://www.ng3k.com/misc/adxo.html",qrz_url="https://www.qrz.com/db/";function findCountry(e,t){for(var a=0;a<e.length;a++)if(e[a].WPX==t)return e[a]}function findAdxo(e,t){if(e)for(var a=0;a<e.length;a++)if(e[a].callsign==t)return e[a]}function buildHtmlTable(e,t,a,n,r){if(null!=t){var l=new Array,d=new Date,o="00"+d.getUTCDate();o=o.substring(o.length-2,o.length);var s="00"+(Number(d.getUTCMonth())+1);s=s.substring(s.length-2,s.length);var c=d.getUTCFullYear();dt_current=o+"/"+s+"/"+c,$(e).empty();for(var i=0;i<t.length;i++){l[i]=t[i].rowid;var p=$('<tr id="'+t[i].rowid+'"/>'),u=a.find(e=>e==t[i].rowid);null!=r?r==t[i].de?p=$('<tr id="'+t[i].rowid+'"/>'):r==t[i].dx&&(p=$('<tr id="'+t[i].rowid+'"/>')):null==u&&a.length>0&&(p=$('<tr class="table-info" id="'+t[i].rowid+'"/>'));var b=findCountry(n,t[i].spotdxcc);t[i].de==r?de="<mark>"+t[i].de+"</mark>":de=t[i].de,p.append($("<td/>").html('<a href="'+qrz_url+t[i].de+'" target="_blank" rel="noopener"><i class="bi-search" role="button" aria-label="'+t[i].de+'"></i></a><span>&nbsp'+de+"</span></b>"));var g=Intl.NumberFormat("it-IT",{style:"decimal"}).format(t[i].freq);p.append($("<td/>").html('<span class="badge bg-warning text-dark badge-responsive">'+g+"</span>")),t[i].dx==r?dx="<mark>"+t[i].dx+"</mark>":dx=t[i].dx;var m=findAdxo(my_adxo_events,t[i].dx),h="<a href="+adxo_url+" target=_blank rel=noopener >NG3K Website</a>";null!=m&&(dx=dx+'&nbsp<i tabindex="0" class="bi-megaphone-fill" style="color: cornflowerblue; " role="button" aria-label="dx_operations" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="focus" data-bs-sanitize="true" data-bs-placement="auto" data-bs-html="true" data-bs-title="Announced DX Op.: '+m.summary+'" data-bs-content="'+m.description+" data from &nbsp"+h+'"></i>'),p.append($("<td/>").html('<a href="'+qrz_url+t[i].dx+'" target="_blank" rel="noopener"><i class="bi-search" role="button" aria-label="'+t[i].dx+'"></i></a><span>&nbsp'+dx+"</span>"));try{p.append($("<td/>").html('<span class="img-flag flag-icon flag-icon-'+b.ISO+'" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover" data-bs-placement="left" data-bs-content="'+b.desc+'"></span>'))}catch(e){p.append($("<td/>"))}p.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(b.desc)),p.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(t[i].comm));var f=new Date(1e3*t[i].time),v="00"+f.getUTCHours();v=v.substring(v.length-2,v.length);var y="00"+f.getMinutes();y=y.substring(y.length-2,y.length);var x="00"+f.getUTCDate();x=x.substring(x.length-2,x.length);var w="00"+(Number(f.getUTCMonth())+1);w=w.substring(w.length-2,w.length);var _=f.getUTCFullYear();tm=v+":"+y,(f=x+"/"+w+"/"+_)==dt_current?p.append($("<td/>").html(tm)):p.append($("<td/>").html('<table class="table-sm table-borderless"><tbody><tr style="background-color:transparent"><td>'+tm+"</td></tr><tr><td>"+f+"</td></tr></tbody></table>")),$(e).append(p)}$(function(){$('[data-bs-toggle="popover"]').popover({container:e})});try{return Array.from(l)}catch(e){return}}}function mySearch(e){e.preventDefault(),myTimer()}function myTimer(){var e=new XMLHttpRequest;selectedBand=[].map.call(document.getElementById("band").selectedOptions,e=>e.value),selectedDEre=[].map.call(document.getElementById("de_re").selectedOptions,e=>e.value),selectedDXre=[].map.call(document.getElementById("dx_re").selectedOptions,e=>e.value),selectedMode=[].map.call(document.getElementById("mode").selectedOptions,e=>e.value);var t="",a="";selectedBand.length<14&&(t=selectedBand.map(function(e,t){return"b="+e}).join("&"));var n="";selectedDEre.length<7&&(n=selectedDEre.map(function(e,t){return"e="+e}).join("&")),a=t&&n?t.concat("&".concat(n)):t.concat(n);var r="";selectedDXre.length<7&&(r=selectedDXre.map(function(e,t){return"x="+e}).join("&")),a=a&&r?a.concat("&".concat(r)):a.concat(r);var l="";selectedMode.length<3&&(l=selectedMode.map(function(e,t){return"m="+e}).join("&"));var d="spotlist";(a=a&&l?a.concat("&".concat(l)):a.concat(l))&&(d=d.concat("?".concat(a))),e.open("GET",d,!0),e.onload=function(){try{rows_list=buildHtmlTable("#bodyspot",JSON.parse(this.response),rows_list,my_countries.country_codes)}catch(e){console.log(e),console.log(e.stack)}},e.send()}