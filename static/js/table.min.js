var adxo_url="https://www.ng3k.com/misc/adxo.html",qrz_url="https://www.qrz.com/db/";function findAdxo(a,c){if(a){for(var b=0;b<a.length;b++)if(a[b].callsign==c)return a[b]}}function buildHtmlTable(n,b,o,e){if(null!=b){var p=new Array,l=new Date,f="00"+l.getUTCDate();f=f.substring(f.length-2,f.length);var k="00"+(Number(l.getUTCMonth())+1);dt_current=f+"/"+(k=k.substring(k.length-2,k.length))+"/"+l.getUTCFullYear(),$(n).empty();for(var a=0;a<b.length;a++){p[a]=b[a].rowid;var c=$('<tr id="'+b[a].rowid+'"/>'),q=o.find(c=>c==b[a].rowid);void 0!=e?e==b[a].de?c=$('<tr id="'+b[a].rowid+'"/>'):e==b[a].dx&&(c=$('<tr id="'+b[a].rowid+'"/>')):void 0==q&&o.length>0&&(c=$('<tr class="table-info" id="'+b[a].rowid+'"/>')),de=b[a].de==e?"<mark>"+b[a].de+"</mark>":b[a].de,c.append($("<td/>").html('<a href="'+qrz_url+b[a].de+'" target="_blank" rel="noopener"><i class="bi-search" role="button" aria-label="'+b[a].de+'"></i></a><span>&nbsp'+de+"</span></b>"));var r=Intl.NumberFormat("it-IT",{style:"decimal"}).format(b[a].freq);c.append($("<td/>").html('<span class="badge bg-warning text-dark badge-responsive">'+r+"</span>")),dx=b[a].dx==e?"<mark>"+b[a].dx+"</mark>":b[a].dx;var m=findAdxo(my_adxo_events,b[a].dx),s="<a href="+adxo_url+" target=_blank rel=noopener >NG3K Website</a>";void 0!=m&&(dx=dx+'&nbsp<i tabindex="0" class="bi-megaphone-fill" style="color: cornflowerblue; " role="button" aria-label="dx_operations" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="focus" data-bs-sanitize="true" data-bs-placement="auto" data-bs-html="true" data-bs-title="Announced DX Op.: '+m.summary+'" data-bs-content="'+m.description+" data from &nbsp"+s+'"></i>'),c.append($("<td/>").html('<a href="'+qrz_url+b[a].dx+'" target="_blank" rel="noopener"><i class="bi-search" role="button" aria-label="'+b[a].dx+'"></i></a><span>&nbsp'+dx+"</span>"));try{c.append($("<td/>").html('<span class="img-flag fi fi-'+b[a].iso+'" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover" data-bs-placement="left" data-bs-content="'+b[a].country+'"></span>'))}catch(u){c.append($("<td/>"))}c.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(b[a].country)),c.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(b[a].comm));var d=new Date(1e3*b[a].time),g="00"+d.getUTCHours();g=g.substring(g.length-2,g.length);var h="00"+d.getMinutes();h=h.substring(h.length-2,h.length);var i="00"+d.getUTCDate();i=i.substring(i.length-2,i.length);var j="00"+(Number(d.getUTCMonth())+1);j=j.substring(j.length-2,j.length);var t=d.getUTCFullYear();tm=g+":"+h,(d=i+"/"+j+"/"+t)==dt_current?c.append($("<td/>").html(tm)):c.append($("<td/>").html('<table class="table-sm table-borderless"><tbody><tr style="background-color:transparent"><td>'+tm+"</td></tr><tr><td>"+d+"</td></tr></tbody></table>")),$(n).append(c)}$(function(){$('[data-bs-toggle="popover"]').popover({container:n})});try{return Array.from(p)}catch(v){return}}}function mySearch(a){a.preventDefault(),myTimer()}function getFilter(d,e,b,a){selectedFilter=[].map.call(document.getElementById(d).selectedOptions,a=>a.value);var c="";return(selectedFilter.length<b|| -1==b)&&(c=selectedFilter.map(function(a){return a?e+"="+a:""}).join("&"),"&"==(a=a.concat("&".concat(c))).substring(0,1)&&(a=a.substring(1))),a}function myTimer(){var b=new XMLHttpRequest,a="";a=getFilter("band","b",14,a),a=getFilter("de_re","e",7,a),a=getFilter("dx_re","x",7,a),a=getFilter("mode","m",3,a),a=getFilter("cqdeInput","qe",-1,a);var c="spotlist";(a=getFilter("cqdxInput","qx",-1,a))&&(c=c.concat("?".concat(a))),b.open("GET",c,!0),b.onload=function(){try{rows_list=buildHtmlTable("#bodyspot",JSON.parse(this.response),rows_list)}catch(a){console.log(a),console.log(a.stack)}},b.send()}
