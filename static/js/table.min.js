var adxo_url="http://www.ng3k.com/misc/adxo.html",qrz_url="https://www.qrz.com/db/";function findAdxo(e,t){if(e)for(var a=0;a<e.length;a++)if(e[a].callsign==t)return e[a]}function isNumeric(e){return/^-?\d+$/.test(e)}function buildHtmlTable(e,t,a,n){if(null!=t){var l=new Array,r=new Date,d="00"+r.getUTCDate();d=d.substring(d.length-2,d.length);var o="00"+(Number(r.getUTCMonth())+1);o=o.substring(o.length-2,o.length);var c=r.getUTCFullYear();dt_current=d+"/"+o+"/"+c,$(e).empty();for(var s=0;s<t.length;s++){l[s]=t[s].rowid;var i=$('<tr id="'+t[s].rowid+'"/>'),u=a.find(e=>e==t[s].rowid);null!=n?n==t[s].de?i=$('<tr id="'+t[s].rowid+'"/>'):n==t[s].dx&&(i=$('<tr id="'+t[s].rowid+'"/>')):null==u&&a.length>0&&(i=$('<tr class="table-info" id="'+t[s].rowid+'"/>')),t[s].de==n?de="<mark>"+t[s].de+"</mark>":de=t[s].de,i.append($("<td/>").html('<a href="'+qrz_url+t[s].de+'" target="_blank" rel="noopener"><i class="bi-search" role="button" aria-label="'+t[s].de+'"></i></a><span>&nbsp'+de+"</span></b>"));var p=Intl.NumberFormat("it-IT",{style:"decimal"}).format(t[s].freq);i.append($("<td/>").html('<span class="badge bg-warning text-dark badge-responsive">'+p+"</span>")),t[s].dx==n?dx="<mark>"+t[s].dx+"</mark>":dx=t[s].dx;var g=findAdxo(my_adxo_events,t[s].dx),b="<a href="+adxo_url+" target=_blank rel=noopener >NG3K Website</a>";null!=g&&(dx=dx+'&nbsp<i tabindex="0" class="bi-megaphone-fill" style="color: cornflowerblue; " role="button" aria-label="dx_operations" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="focus" data-bs-sanitize="true" data-bs-placement="auto" data-bs-html="true" data-bs-title="Announced DX Op.: '+g.summary+'" data-bs-content="'+g.description+" data from &nbsp"+b+'"></i>'),i.append($("<td/>").html('<a href="'+qrz_url+t[s].dx+'" target="_blank" rel="noopener"><i class="bi-search" role="button" aria-label="'+t[s].dx+'"></i></a><span>&nbsp'+dx+"</span>"));try{i.append($("<td/>").html('<span class="img-flag flag-icon flag-icon-'+t[s].iso+'" data-bs-container="body" data-bs-toggle="popover" data-bs-trigger="hover" data-bs-placement="left" data-bs-content="'+t[s].country+'"></span>'))}catch(e){i.append($("<td/>"))}i.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(t[s].country)),i.append($('<td class="d-none d-lg-table-cell d-xl-table-cell"/>').html(t[s].comm));var m=new Date(1e3*t[s].time),h="00"+m.getUTCHours();h=h.substring(h.length-2,h.length);var f="00"+m.getMinutes();f=f.substring(f.length-2,f.length);var v="00"+m.getUTCDate();v=v.substring(v.length-2,v.length);var x="00"+(Number(m.getUTCMonth())+1);x=x.substring(x.length-2,x.length);var y=m.getUTCFullYear();tm=h+":"+f,(m=v+"/"+x+"/"+y)==dt_current?i.append($("<td/>").html(tm)):i.append($("<td/>").html('<table class="table-sm table-borderless"><tbody><tr style="background-color:transparent"><td>'+tm+"</td></tr><tr><td>"+m+"</td></tr></tbody></table>")),$(e).append(i)}$(function(){$('[data-bs-toggle="popover"]').popover({container:e})});try{return Array.from(l)}catch(e){return}}}function mySearch(e){e.preventDefault(),myTimer()}function getSingleFilter(e,t,a){try{selectedFilter=document.getElementById(e).value;var n="";isNumeric(selectedFilter)&&(n=t+"="+selectedFilter),a=a&&n?a.concat("&".concat(n)):a.concat(n)}catch(e){}return a}function myTimer(){var e=new XMLHttpRequest;selectedBand=[].map.call(document.getElementById("band").selectedOptions,e=>e.value),selectedDEre=[].map.call(document.getElementById("de_re").selectedOptions,e=>e.value),selectedDXre=[].map.call(document.getElementById("dx_re").selectedOptions,e=>e.value),selectedMode=[].map.call(document.getElementById("mode").selectedOptions,e=>e.value);var t="",a="";selectedBand.length<14&&(t=selectedBand.map(function(e,t){return"b="+e}).join("&"));var n="";selectedDEre.length<7&&(n=selectedDEre.map(function(e,t){return"e="+e}).join("&")),a=t&&n?t.concat("&".concat(n)):t.concat(n);var l="";selectedDXre.length<7&&(l=selectedDXre.map(function(e,t){return"x="+e}).join("&")),a=a&&l?a.concat("&".concat(l)):a.concat(l);var r="";selectedMode.length<3&&(r=selectedMode.map(function(e,t){return"m="+e}).join("&")),a=getSingleFilter("cqdeInput","qe",a=a&&r?a.concat("&".concat(r)):a.concat(r));var d="spotlist";(a=getSingleFilter("cqdxInput","qx",a))&&(d=d.concat("?".concat(a))),console.log(d),e.open("GET",d,!0),e.onload=function(){try{rows_list=buildHtmlTable("#bodyspot",JSON.parse(this.response),rows_list)}catch(e){console.log(e),console.log(e.stack)}},e.send()}